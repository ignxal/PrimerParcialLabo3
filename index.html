<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script>
      ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
      ///////////////////////////////////////////////////////// PUNTO 1 //////////////////////////////////////////////////////
      ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
      class Persona {
        constructor(id, nombre, apellido, edad) {
          if (!id || !nombre || !apellido || !edad) {
            throw new Error(
              "Los campos id, nombre, apellido y edad son obligatorios."
            );
          }
          this.id = id;
          this.nombre = nombre;
          this.apellido = apellido;
          this.edad = edad;
        }
      }

      class Heroe extends Persona {
        constructor(id, nombre, apellido, edad, alterEgo, ciudad, publicado) {
          super(id, nombre, apellido, edad);
          if (!alterEgo || !ciudad || !publicado) {
            throw new Error(
              "Los campos alterEgo, ciudad y publicado son obligatorios."
            );
          }
          if (typeof publicado !== "number")
            throw new Error("El dato publicado debe ser de tipo numerico.");
          if (publicado <= 1940)
            throw new Error("La fecha de publicacion debe ser mayor a 1940.");

          this.alterEgo = alterEgo;
          this.ciudad = ciudad;
          this.publicado = publicado;
        }
      }

      class Villano extends Persona {
        constructor(id, nombre, apellido, edad, enemigo, robos, asesinatos) {
          super(id, nombre, apellido, edad);
          if (!enemigo || !robos || !asesinatos) {
            throw new Error(
              "Los campos enemigo, robos y asesinatos son obligatorios."
            );
          }

          if (typeof robos !== "number" || typeof asesinatos !== "number")
            throw new Error(
              "Los robos y asesinatos deben ser datos de tipo numerico."
            );

          if (robos < 0 || asesinatos < 0)
            throw new Error("Los robos y asesinatos deben ser mayores a 0.");
          this.enemigo = enemigo;
          this.robos = robos;
          this.asesinatos = asesinatos;
        }
      }

      window.addEventListener("load", () => {
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        ///////////////////////////////////////////////////////// PUNTO 2 //////////////////////////////////////////////////////
        ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        const datos = JSON.parse(
          '[{"id":1, "nombre":"Clark", "apellido":"Kent", "edad":45, "alterego":"Superman", "ciudad":"Metropolis","publicado":2002},{"id":2, "nombre":"Bruce", "apellido":"Wayne", "edad":35, "alterego":"Batman", "ciudad":"Gotica","publicado":20012},{"id":3, "nombre":"Bart", "apellido":"Alen", "edad":30, "alterego":"Flash", "ciudad":"Central","publicado":2017},{"id":4, "nombre":"Lex", "apellido":"Luthor", "edad":18, "enemigo":"Superman", "robos":500,"asesinatos":7},{"id":5, "nombre":"Harvey", "apellido":"Dent", "edad":20, "enemigo":"Batman", "robos":750,"asesinatos":2},{"id":666, "nombre":"Celina", "apellido":"kyle", "edad":23, "enemigo":"Batman", "robos":25,"asesinatos":1}]'
        );
        const personas = [];

        datos.forEach((x) => {
          if ("alterego" in x && "ciudad" in x && "publicado" in x) {
            personas.push(
              new Heroe(
                x.id,
                x.nombre,
                x.apellido,
                x.edad,
                x.alterego,
                x.ciudad,
                x.publicado
              )
            );
          } else if ("enemigo" in x && "robos" in x && "asesinatos" in x) {
            personas.push(
              new Villano(
                x.id,
                x.nombre,
                x.apellido,
                x.edad,
                x.enemigo,
                x.robos,
                x.asesinatos
              )
            );
          } else {
            personas.push(new Persona(x.id, x.nombre, x.apellido, x.edad));
          }
        });

        console.log(personas);
        this.datosTotales = personas;
        this.datosActuales = personas;
      });
    </script>
  </head>
</html>
